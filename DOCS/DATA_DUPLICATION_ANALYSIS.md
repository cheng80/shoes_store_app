# 데이터 중복성 분석 및 재분배 제안

**작성일**: 2025-01-XX  
**목적**: 주문/반품 조회 화면의 데이터 중복성 분석 및 효율적인 작업 분담

---

## 📊 데이터 중복성 분석

### 1. 주문 내역 조회 비교

| 항목 | 사용자용 | 관리자용 | 차이점 |
|------|---------|---------|--------|
| **필요 테이블** | `purchase_item`, `product`, `branch` | `purchase_item`, `user`, `product`, `branch` | 관리자용에 `user` 추가 |
| **필요 컬럼** | `purchase_item`: `b_seq`, `b_tnum`, `b_date`, `b_price`, `b_quantity`, `p_seq`, `br_seq`<br>`product`: `p_seq`, `p_name`, `p_price`, `p_image`<br>`branch`: `br_seq`, `br_name` | `purchase_item`: `b_seq`, `b_tnum`, `b_date`, `b_price`, `b_quantity`, `u_seq`, `p_seq`, `br_seq`<br>`user`: `u_seq`, `u_name`, `u_phone`<br>`product`: `p_seq`, `p_name`, `p_image`<br>`branch`: `br_seq`, `br_name` | 관리자용에 `user` 정보 추가 |
| **API 로직** | `WHERE u_seq = ?` (자신의 주문만) | `WHERE` 조건 없음 또는 필터링 (전체 주문) | 필터링 조건만 다름 |
| **JOIN 쿼리** | 동일 | 동일 | 동일 |
| **개발 API** | `GET /api/purchase_items/by_user/{user_seq}/orders`<br>`GET /api/purchase_items/by_user/{user_seq}/with_details` | `GET /api/purchase_items`<br>`GET /api/purchase_items/by_tnum/{b_tnum}/with_details` | 거의 동일한 로직 |

**결론**: 거의 동일한 API, 필터링 조건만 다름 (약 90% 중복)

---

### 2. 주문 상세 조회 비교

| 항목 | 사용자용 | 관리자용 | 차이점 |
|------|---------|---------|--------|
| **필요 테이블** | `purchase_item`, `user`, `product`, `branch`, `pickup`, 모든 카테고리, `maker` | `purchase_item`, `user`, `product`, `branch`, `pickup`, 모든 카테고리, `maker` | 동일 |
| **필요 컬럼** | 거의 동일 | 거의 동일 | 동일 |
| **API 로직** | 조회만 가능 | 조회 + 수령 처리 가능 | 관리자용에 수령 처리 기능 추가 |
| **JOIN 쿼리** | 동일 | 동일 | 동일 |
| **개발 API** | `GET /api/purchase_items/by_tnum/{b_tnum}/with_details`<br>`GET /api/purchase_items/{b_seq}/full_detail` | `GET /api/purchase_items/{b_seq}/full_detail`<br>`GET /api/purchase_items/by_tnum/{b_tnum}/with_details`<br>`POST /api/pickups/{pic_seq}/complete` | 거의 동일, 관리자용에 수령 처리 API 추가 |

**결론**: 거의 동일한 API, 관리자용에 수령 처리 기능만 추가 (약 85% 중복)

---

### 3. 반품 목록 조회 비교

| 항목 | 사용자용 | 관리자용 | 차이점 |
|------|---------|---------|--------|
| **필요 테이블** | `pickup`, `purchase_item`, `product`, `branch`, `refund`, `staff` | `refund`, `user`, `staff`, `pickup`, `purchase_item`, `product` | 테이블 순서만 다름, 동일 |
| **필요 컬럼** | 거의 동일 | 거의 동일 | 동일 |
| **API 로직** | `WHERE u_seq = ?` (자신의 반품만) | `WHERE` 조건 없음 또는 필터링 (전체 반품) | 필터링 조건만 다름 |
| **JOIN 쿼리** | 동일 | 동일 | 동일 |
| **개발 API** | `GET /api/pickups/by_user/{user_seq}/with_details`<br>`GET /api/refunds/by_user/{user_seq}/with_details` | `GET /api/refunds`<br>`GET /api/refunds/by_staff/{staff_seq}/with_details` | 거의 동일한 로직 |

**결론**: 거의 동일한 API, 필터링 조건만 다름 (약 90% 중복)

---

### 4. 반품 상세 조회 비교

| 항목 | 사용자용 | 관리자용 | 차이점 |
|------|---------|---------|--------|
| **필요 테이블** | `pickup`, `purchase_item`, `product`, `branch`, `refund`, `staff`, 모든 카테고리, `maker` | `refund`, `user`, `staff`, `pickup`, `purchase_item`, `product`, `branch`, 모든 카테고리, `maker` | 동일 |
| **필요 컬럼** | 거의 동일 | 거의 동일 | 동일 |
| **API 로직** | 조회 + 반품 신청만 가능 | 조회 + 반품 처리 가능 | 관리자용에 반품 처리 기능 추가 |
| **JOIN 쿼리** | 동일 | 동일 | 동일 |
| **개발 API** | `GET /api/pickups/{pic_seq}/full_detail`<br>`GET /api/refunds/{refund_seq}/full_detail`<br>`POST /api/refunds` | `GET /api/refunds/{refund_seq}/full_detail`<br>`POST /api/refunds/{refund_seq}/process` | 거의 동일, 관리자용에 반품 처리 API 추가 |

**결론**: 거의 동일한 API, 관리자용에 반품 처리 기능만 추가 (약 85% 중복)

---

## 💡 재분배 제안

### 옵션 A: 주문/반품 조회 통합 담당 (권장)

**핵심 아이디어**: 사용자용과 관리자용이 거의 동일한 데이터와 API를 사용하므로, 한 사람이 담당하여 중복 작업을 방지하고 API 재사용성을 높입니다.

| 담당자 | 화면 수 | 담당 화면 | 복잡도 점수 | 주요 작업 |
|--------|--------|----------|------------|----------|
| **담당자 1** | 6개 | 사용자 로그인, 사용자 메뉴 드로어, 사용자-회원가입, 사용자-개인정보 수정, 관리자-로그인, 관리자-드로어 메뉴 | **6점** | 사용자/관리자 인증 및 기본 UI |
| **담당자 2** | 3개 | 사용자-상품조회, 상품상세화면, 관리자-개인정보 수정 | **7점** | 상품 관리, 관리자 개인정보 |
| **담당자 3** | 4개 | 사용자-장바구니, 사용자-주소:결제방법, 사용자-결제팝업, 사용자-결제하기 | **10점** | 결제 프로세스 |
| **담당자 4** | 8개 | 사용자- 주문내역 조회, 사용자- 주문내역 조회(상세화면), 사용자-수령 반품목록 조회, 사용자-수령 반품목록 조회(상세화면), 관리자-주문목록 조회, 관리자-주문목록 조회(상세화면), 관리자-반품목록 조회, 관리자-반품목록 조회(상세화면) | **22점** | 주문/반품 조회 (사용자 + 관리자 통합) |
| **담당자 5** | 0개 | - | **0점** | - |

**문제점**: 담당자 4에게 작업이 너무 몰림 (8개 화면, 22점)

---

### 옵션 B: 주문/반품 조회 분리 유지 (현재)

| 담당자 | 화면 수 | 담당 화면 | 복잡도 점수 | 주요 작업 |
|--------|--------|----------|------------|----------|
| **담당자 1** | 6개 | 사용자 로그인, 사용자 메뉴 드로어, 사용자-회원가입, 사용자-개인정보 수정, 관리자-로그인, 관리자-드로어 메뉴 | **6점** | 사용자/관리자 인증 및 기본 UI |
| **담당자 2** | 3개 | 사용자-상품조회, 상품상세화면, 관리자-개인정보 수정 | **7점** | 상품 관리, 관리자 개인정보 |
| **담당자 3** | 4개 | 사용자-장바구니, 사용자-주소:결제방법, 사용자-결제팝업, 사용자-결제하기 | **10점** | 결제 프로세스 |
| **담당자 4** | 4개 | 사용자- 주문내역 조회, 사용자- 주문내역 조회(상세화면), 사용자-수령 반품목록 조회, 사용자-수령 반품목록 조회(상세화면) | **10점** | 사용자 주문/반품 조회 |
| **담당자 5** | 4개 | 관리자-주문목록 조회, 관리자-주문목록 조회(상세화면), 관리자-반품목록 조회, 관리자-반품목록 조회(상세화면) | **12점** | 관리자 주문/반품 관리 |

**장점**: 화면 수 균등 (3-6개), 복잡도 분산 (6-12점)  
**단점**: 거의 동일한 API를 두 명이 개발 (중복 작업 가능성)

---

### 옵션 C: 주문/반품 조회 통합 + 다른 작업 분산 (최종 권장)

**핵심 아이디어**: 주문/반품 조회를 한 사람이 담당하되, 다른 작업을 분산하여 균형을 맞춥니다.

| 담당자 | 화면 수 | 담당 화면 | 복잡도 점수 | 주요 작업 |
|--------|--------|----------|------------|----------|
| **담당자 1** | 6개 | 사용자 로그인, 사용자 메뉴 드로어, 사용자-회원가입, 사용자-개인정보 수정, 관리자-로그인, 관리자-드로어 메뉴 | **6점** | 사용자/관리자 인증 및 기본 UI |
| **담당자 2** | 4개 | 사용자-상품조회, 상품상세화면, 관리자-개인정보 수정, 사용자-주소:결제방법 | **8점** | 상품 관리, 관리자 개인정보, 결제 준비 |
| **담당자 3** | 3개 | 사용자-장바구니, 사용자-결제팝업, 사용자-결제하기 | **9점** | 결제 프로세스 (핵심만 집중) |
| **담당자 4** | 8개 | 사용자- 주문내역 조회, 사용자- 주문내역 조회(상세화면), 사용자-수령 반품목록 조회, 사용자-수령 반품목록 조회(상세화면), 관리자-주문목록 조회, 관리자-주문목록 조회(상세화면), 관리자-반품목록 조회, 관리자-반품목록 조회(상세화면) | **22점** | 주문/반품 조회 (사용자 + 관리자 통합) |
| **담당자 5** | 0개 | - | **0점** | - |

**문제점**: 담당자 4에게 작업이 너무 몰림, 담당자 5는 작업 없음

---

## ✅ 최종 권장안: 옵션 B (현재 분배 유지)

### 재분배 결과

| 담당자 | 화면 수 | 복잡도 점수 | 주요 작업 |
|--------|--------|------------|----------|
| **담당자 1** | 6개 | 6점 | 사용자/관리자 인증 및 기본 UI |
| **담당자 2** | 3개 | 7점 | 상품 관리, 관리자 개인정보 |
| **담당자 3** | 4개 | 10점 | 결제 프로세스 (핵심 비즈니스 로직) |
| **담당자 4** | 4개 | 10점 | 사용자 주문/반품 조회 |
| **담당자 5** | 4개 | 12점 | 관리자 주문/반품 관리 |

**평균 화면 수**: 4.2개/인  
**평균 복잡도**: 9점/인

### 권장 이유

1. **화면 수 균등**: 3-6개로 분산 (담당자 1이 6개지만 모두 단순 작업)
2. **복잡도 분산**: 6-12점으로 분산
3. **명확한 책임 분리**: 사용자용과 관리자용을 분리하여 요구사항 변경 시 영향도 최소화
4. **API 재사용 가능**: 담당자 4와 5가 협의하여 공통 API를 먼저 개발하고, 각각 필터링 조건만 추가

### 협업 제안

**담당자 4와 5의 협업 방식:**
1. 공통 API 먼저 개발 (담당자 4 또는 5 중 한 명이 주도)
2. 사용자용: `WHERE u_seq = ?` 조건 추가
3. 관리자용: 필터링 파라미터 추가
4. 코드 공유 및 리뷰를 통한 중복 방지

---

**결론**: 현재 분배(옵션 B)를 권장합니다. 화면 수와 복잡도가 균형잡혀 있으며, 담당자 4와 5가 협업하여 중복 작업을 방지할 수 있습니다.

